{"version":3,"sources":["../scripts.babel/contentscript.js"],"names":[],"mappings":"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","file":"contentscript.js","sourcesContent":["'use strict';\n\nvar clickedElem = null;\nvar popupElem = null;\n\nvar inputTypes = [\n  'text',\n  'search',\n  'url',\n  'email'\n];\n\nvar autolookup;\nvar autolookupOnMultiple;\n\nfunction loadOptions() {\n  chrome.storage.sync.get({\n    autolookup: true,\n    autolookupOnMultiple: true\n  }, function(items) {\n    autolookup = items.autolookup;\n    autolookupOnMultiple = items.autolookupOnMultiple;\n  });\n}\n\ndocument.addEventListener(\"mousedown\", function(event) {\n  if(event.button === 2 && event.target.tagName.toLowerCase() === 'input') {\n    clickedElem = event.target;\n  }\n});\n\ndocument.addEventListener(\"blur\", function(event) {\n  loadOptions();\n  if(autolookup && event.target.tagName.toLowerCase() === 'input' && typeof(event.target.attributes['type']) !== 'undefined' && inputTypes.indexOf(event.target.attributes['type'].value) != -1) {\n    chrome.runtime.sendMessage(chrome.runtime.id, {type: 'getWalletCurrencies', lookupValue: event.target.value});\n    return true;\n  }\n}, true);\n\nfunction fireEvent(obj, evt){\n  var fireOnThis = obj;\n  if( document.createEvent ) {\n    var evObj = document.createEvent('MouseEvents');\n    evObj.initEvent( evt, true, false );\n    fireOnThis.dispatchEvent( evObj );\n  }\n  else if( document.createEventObject ) { //IE\n    var evObj = document.createEventObject();\n    fireOnThis.fireEvent( 'on' + evt, evObj );\n  }\n}\n\nfunction updateInputWithWalletName(walletName, walletAddress) {\n\n  var updatedElem = null;\n\n  // If we already know the element, skip search\n  if(clickedElem != null && clickedElem.tagName.toLowerCase() === 'input') {\n    if(clickedElem.value === walletName) {\n      clickedElem.value = walletAddress;\n      updatedElem = clickedElem;\n    }\n  } else {\n    // If we don't have the element, search for it\n    var elements = document.getElementsByTagName('input');\n    for(var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      if(element.value === walletName) {\n        element.value = walletAddress;\n        updatedElem = element;\n        break;\n      }\n    }\n  }\n\n  // Fire a blur event if we've updated an input field to activate data-binding found in Angular/React/etc.\n  if(updatedElem != null) {\n    window.setTimeout(function() {\n      fireEvent(updatedElem, 'change');\n      fireEvent(updatedElem, 'blur');\n    }, 50);\n  }\n\n}\n\nfunction showAvailableCurrencies(walletName, currencies) {\n\n  loadOptions();\n  if(currencies.length > 1 && !autolookupOnMultiple) {\n    return;\n  }\n\n  // Convert Shortcode to Currency Names -> IF AVAILABLE\n  var optStr = \"\";\n  for(var i = 0; i < currencies.length; i++) {\n    var option = $('<option value=\"' + currencies[i] + '\">' + SHORTCODES[currencies[i]] + '</option>');\n    optStr += option.prop('outerHTML');\n  }\n\n  // Open Popup with options and lookup button\n  var modalHtml = '<div class=\"nk-currency-popup-modal\" id=\"netki-currency-popup\">';\n  modalHtml += '<div class=\"nk-modal-header\"><img src=\"' + chrome.extension.getURL('images/icon-38.png') + '\" border=\"0\" style=\"vertical-align: middle\">&nbsp;Netki Wallet Name Lookup</div>';\n  modalHtml += '<div class=\"nk-modal-body\">';\n  modalHtml += '<form><div class=\"nk-form-group\">';\n  modalHtml += '<label class=\"nk-avail-currencies-label\" for=\"lookupCurrency\">Available Currencies</label>';\n  modalHtml += '<select class=\"nk-form-control\" name=\"lookupCurrency\">';\n  modalHtml += optStr;\n  modalHtml += '</select></div><br/>';\n  modalHtml += '<button class=\"nk-lookup-button\" type=\"submit\">Lookup Currency Address</button>';\n  modalHtml += '</form></div></div>';\n  \n\n  popupElem = $(modalHtml);\n  var formElem = popupElem.find('form');\n  formElem.submit(function() {\n    lookupWalletName(walletName);\n    return false;\n  });\n\n  popupElem.appendTo('body').modal({showSpinner: false, zIndex: 99998});\n}\n\nfunction showNotFoundMessage(walletName) {\n  if(clickedElem == null) {\n    return;\n  }\n\n  var modalHtml = '<div class=\"nk-currency-popup-modal\">';\n  modalHtml += '<div class=\"nk-modal-header nk-failed\"><img src=\"' + chrome.extension.getURL('images/icon-38.png') + '\" border=\"0\" style=\"vertical-align: middle\">&nbsp;Wallet Name Lookup Failed</div>';\n  modalHtml += '<div class=\"nk-modal-body\">Wallet Name <strong>' + walletName + '</strong> does not exist!</div>';\n  modalHtml += '</div>';\n  var errorElem = $(modalHtml);\n  errorElem.appendTo('body').modal({showSpinner: false, zIndex: 99998});\n}\n\nfunction lookupWalletName(walletName) {\n  $(\"#netki-currency-popup select\").each(function() {\n      if($(this).attr('name') === 'lookupCurrency') {\n        var msg = {\n          type: 'walletNameLookup',\n          wn: walletName,\n          currency: $(this).val()\n        };\n\n        chrome.runtime.sendMessage(chrome.runtime.id, msg);\n      }\n    $.modal.close();\n    popupElem.remove();\n  });\n}\n\nchrome.runtime.onMessage.addListener(function(message, sender, sendResponse) {\n  switch(message.args.type) {\n    case 'walletNameResolution':\n      return updateInputWithWalletName(message.args.walletName, message.args.walletAddress);\n\n    case 'availableCurrencies':\n      return showAvailableCurrencies(message.args.walletName, message.args.currencies);\n\n    case 'walletNameNotFound':\n      return showNotFoundMessage(message.args.walletName);\n  }\n});\n\n// Add Hidden Popup Div\nvar cssUrl = chrome.extension.getURL(\"styles/jquery.modal.css\");\nvar link = $('<link href=\"' + cssUrl + '\" type=\"text/css\" rel=\"stylesheet\">');\n$('head').append(link);\n\nloadOptions();"]}